%!TEX root = ../thesis.tex
%*******************************************************************************
%****************************** Information capacity Chapter **********************************
%*******************************************************************************
\chapter{Information capacity of phase-only computer-generated holograms for holographic displays}
\label{chapter:information capacity}

\graphicspath{{Chapter_Information_capacity/Figs/}}

\section{abstract}
	Despite many years of development in computer-generated holography, perfect phase-only holograms for most target images are still yet possible to compute. All computational phase retrieval algorithms end up with some error between the target image and the reconstruction of the computer-generated hologram (CGH), except for specific targets. This research focuses on the fundamental limits of phase-only CGH quantized to limited bit-depth levels, from the information theory point of view, revealing the information capacity of CGH and its effect on reconstruction quality, with an attempt to quantify how hard a target image is for phase-only hologram computation.



\section{Introduction}
	Holography is a technology that can fully reconstruct the wavefront of three-dimensional (3D) objects. Computer-generated holography (CGH) is a technique for converting a 3D object scene into a two-dimensional (2D), complex-valued hologram \cite{Tsang2018}, without the need for the 3D object to physically exist. However, despite many advancements in liquid crystals and micro mirrors technologies, complex-valued spatial light modulators (SLM) are still not yet available, and the currently available SLM can only achieve either amplitude or phase modulation, among which the phase modulation is usually preferred in holographic projections for its lower zero order and higher energy efficiency due to lower blockage of light. There are many algorithms available to compute good quality phase-only holograms, such as direct binary search \cite{Seldowitz1987}, simulated annealing \cite{Kirkpatrick1983}, Gerchberg-Saxton \cite{Gerchberg1972} and other optimization based methods \cite{Zhang2017, Liu2020, Choi2021, Chen2021, Kadis2022, Sha2023}; however, none of them can guarantee to compute a perfect phase hologram for a 3D or even a 2D image, where they always end up with some error between the reconstruction of the hologram and the target scene, especially when the phase holograms are quantized to be able to display on SLM with limited bit depth. An intuition therefore arose that the bit depth of the phase hologram is limiting the reconstruction quality, and that the target scene's entropy seems to denote how difficult it is for phase hologram generation. It is obvious that the entropy of the target can certainly never exceed the bit depth limit of its corresponded perfect hologram, otherwise a lossless compressor breaking the Shannon's information theory \cite{Shannon1948} would be invented; however, such statement is not quite useful in practice as perfect holograms are generally not even possible to compute.

	A literature review had found no related work on the information entropy of computer-generated holograms, with the closest match being the research on hologram compression using optical method to achieve lossy compression \cite{Kollin1988}, which cannot be integrated in CGH processes. Therefore, this paper aims to investigate how much information content can a bit-depth-limited phase hologram contain, taking from an information theory point of view. Previously, work had been done to investigate the effect of Bit-depth in Stochastic Gradient Descent (SGD) performance for phase-only computer-generated holography displays \cite{Kadis2022}. This paper extends on previous research onto the Gerchberg-Saxton (GS) \cite{Gerchberg1972} algorithms for hologram generation, and investigates the correlation between the quality of the reconstructed image from the hologram and the information entropy of the target image, with an aim to reduce the hologram's entropy during the CGH process, for smaller size holograms.


\section{Methods}
\subsection{Computation of Diffraction}
	To compute the spatial diffraction of light, the Fresnel diffraction formula is used, as shown in Equation~(\ref{eq:fresnel-diffraction}) \cite{Goodman2017}.

	\begin{equation}
	  E_{Fresnel}(\alpha, \beta, z) = \mathcal{F} \left\{A(x,y)e^{j\frac{k}{2z}(x^2+y^2)}\right\}
	  \label{eq:fresnel-diffraction}
	\end{equation}
	where the hologram aperture is denoted by $A(x, y)$ and the diffracted field is denoted by $E(\alpha, \beta, z)$, with $z$ being the distance from the hologram aperture $A(x, y)$, and $j$ is $\sqrt{-1}$, $k$ is the wave number ($k=\frac{2\pi}{\lambda}$, where $\lambda$ is the wavelength), and $\mathcal{F}$ denotes the Fourier Transform. The amplitude of $E(\alpha, \beta, z)$, which is $|E(\alpha, \beta, z)|$, is referred to as the reconstruction of the hologram throughout this paper.

	When $z\gg \frac{k(x^2+y^2)_{max}}{2}$ (i.e. in the far field), Equation~(\ref{eq:fresnel-diffraction}) can be further approximated to give Equation~(\ref{eq:fraunhofer-diffraction}), which is the Fraunhofer diffraction formula \cite{Goodman2017}.
	\begin{equation}
	  E_{Fraunhofer}(\alpha, \beta) = \mathcal{F} \left\{A(x,y)\right\}
	  \label{eq:fraunhofer-diffraction}
	\end{equation}

	To implement the formula on computers, both $A(x, y)$ and $E(\alpha, \beta)$ are discretized, just like digital images. The Fourier Transform $\mathcal{F}$ is discretized using the Fast Fourier Transform (FFT); similarly the inverse Fourier Transform $\mathcal{F}^{-1}$ is discretized using the Inverse Fast Fourier Transform (IFFT) \cite{Cochran1967}.


\subsection{Computer-Generated Hologram (CGH) Algorithm}
	To compute phase-only holograms, the Gerchberg-Saxton (GS) \cite{Gerchberg1972} algorithm, which is the classic and robust phase retrieval algorithm, is selected. Taking the Fraunhofer propagation in Equation~(\ref{eq:fraunhofer-diffraction}) as an example, the operation flowchart of GS algorithm is illustrated in Fig.~\ref{fig:GS_flowchart}. GS algorithm functions that it iteratively determines the phase profile ($\angle A$) of the hologram ($A$) required to reconstruct a target image ($T$); it loops between the hologram ($A$) and the diffracted plane ($E$), and applying constraints to each plane accordingly during each iteration \cite{Gerchberg1972}, with the total number of iterations denoted by $N$.

	\begin{figure} [ht]
	   \begin{center}
	   \includegraphics[width = 0.45\textwidth]{GS_flowchart.eps}
	   \end{center}
	   \caption{\label{fig:GS_flowchart} Gerchberg-Saxton (GS) \cite{Gerchberg1972} algorithm flowchart}
	\end{figure}

	Then, as illustrated in Fig.~\ref{fig:Quantization_bit_depth}, a quantization function ($Q$) can be defined by finding the closest point from one of the $2^d$ quantization levels, given the phase ($\angle A$) and the quantization bit depth $d$ as input.

	\begin{figure} [ht]
		\begin{center}
			\begin{tabular}{c c c c}
				\includegraphics[width = 0.2\textwidth]{Quantization_bit_depth_1.jpg} & \includegraphics[width = 0.2\textwidth]{Quantization_bit_depth_2.jpg} & \includegraphics[width = 0.2\textwidth]{Quantization_bit_depth_4.jpg} & \includegraphics[width = 0.2\textwidth]{Quantization_bit_depth_8.jpg}\\
				(a) bit depth = 1 & (b) bit depth = 2 & (c) bit depth = 4 & (d) bit depth = 8
			\end{tabular}
			\caption{\label{fig:Quantization_bit_depth} Quantization of phase holograms}
		\end{center}
	\end{figure}

	\begin{figure} [ht]
	   \begin{center}
	   \includegraphics[width = 0.45\textwidth]{GS_quantized_flowchart.eps}
	   \end{center}
	   \caption{\label{fig:GS_quantized_flowchart} Quantized Gerchberg-Saxton (GS) algorithm flowchart}
	\end{figure}

	To compute phase holograms quantized to certain bit depth ($d$), the GS algorithm is modified to include an additional quantization operation ($Q$) when applying the 'phase-only' constraint as shown in Fig.~\ref{fig:GS_quantized_flowchart}. Such method is better than applying the quantization at the end of the loop, as it includes the quantization constraint throughout the iterations, instead of introducing significant quantization noise in the end.



\subsection{Measurement of Information}
\subsubsection{Shannon entropy}
	To quantify the information content, the classical one-dimensional (1D) Shannon entropy \cite{Shannon1948} with equation shown in Equation~(\ref{eq:shannon-entropy}) is selected.

	\begin{equation}
		H(X) = -\sum_{x\in X} p(x)\log_2p(x)
		\label{eq:shannon-entropy}
	\end{equation}

	Although the Shannon entropy was designed for 1D data, it can also be implemented to two-dimensional (2D) data by ignoring the 2D spatial correlations and summing $p(x)\log_2p(x)$ over the histogram of the 2D data. As only discrete data can have a meaningful Shannon entropy, the entropy can only be calculated for quantized holograms and target images, which are usually quantized to less than 8 bit depth.


\subsubsection{Delentropy} \label{sec:Delentropy}
	To account for 2D spatial correlation, the delentropy \cite{Larkin2016} is also used. Delentropy is an extension of the 1D Shannon entropy that it first computes the gradient (del) vector field image, whose entropy is then named as the delentropy, so that the spatial image structure and pixel co-occurrence can be captured \cite{Larkin2016}.

	\begin{figure} [ht]
	   \begin{center}
	   \includegraphics[width = 0.45\textwidth]{delentropy.eps}
	   \end{center}
	   \caption{\label{fig:delentropy} Del operation on a sample image}
	\end{figure}

	As an example, the sample image in Fig.~\ref{fig:delentropy}~(a) is the file `0500.png' under the `DIV2K\_train\_HR' folder sourced from the DIV2K dataset \cite{Agustsson2017}. The sample image is calculated to have a Shannon entropy of 7.502 bits/pixel. By taking the $x$-derivative ($f_x$) and $y$-derivative ($f_y$) as shown in Fig.~\ref{fig:delentropy}~(b)~and~(c), and using the Papoulis Generalized Sampling (PGS) \cite{Papoulis1977} theory, the delentropy is calculated using Equation~(\ref{eq:delentropy})\cite{Larkin2016} to be 5.867 bits/pixel.

	\begin{equation}
		H_{PGS}(f_x, f_y) \leq \frac{H(f_x) + H(f_y)}{2}
		\label{eq:delentropy}
	\end{equation}



\section{Results}
\subsection{Targets at far field (Fraunhofer region)} \label{sec:Fraunhofer_results}
	The target images used in this paper are sourced from the DIV2K dataset \cite{Agustsson2017}, among which, all of the 800 images in the `DIV2K\_train\_HR' folder are selected. The quantized GS algorithm in Fig.~\ref{fig:GS_quantized_flowchart} was run on each of the 800 target images set at far field (using the Fraunhofer diffraction formula in Equation~(\ref{eq:fraunhofer-diffraction})), for hologram bit depth set to integers ranging from 1 to 8, with the total number of iterations ($N$) set to 100.

	\begin{figure} [ht]
	   \begin{center}
	   \includegraphics[width = 1.0\textwidth]{holo_bit_depth_recon_Fraunhofer.png}
	   \end{center}
	   \caption{\label{fig:holo_bit_depth_recon_Fraunhofer} Hologram generated at certain bit depths and their according reconstructions at far field}
	\end{figure}

	An example of quantized phase hologram generation for the sample image in Fig.~\ref{fig:delentropy}~(a) is shown in Fig.~\ref{fig:holo_bit_depth_recon_Fraunhofer}, which demonstrates qualitatively how the reconstruction quality improves with the increase in the bit depth of the hologram, and also quantitatively, the normalized mean squared error (NMSE) between the reconstruction and target image has shown a decreasing trend as the bit depth of hologram increases. The rotational symmetry in the reconstruction of the hologram with bit depth 1 can be explained by the conjugate properties of Fourier Transforms, because the binary phase holograms have pixel values whose complex conjugates are the same as themselves.


	\begin{figure} [ht]
	   \begin{center}
	   \includegraphics[trim={80 50 90 70}, clip, width = 0.45\textwidth]{GS_Fraunhofer_NMSE_VS_Hologram bit depth.png}
	   \end{center}
	   \caption{\label{fig:GS_Fraunhofer_NMSE_VS_Hologram_bit_depth} NMSE v.s. Hologram bit depth for target images set at far field}
	\end{figure}

	Fig.~\ref{fig:GS_Fraunhofer_NMSE_VS_Hologram_bit_depth} plots the NMSE between the reconstruction of the hologram and the target image against the hologram bit depth for every 5 images (as there are a total of 800 images, only every 5 images are shown in the plot to avoid overcrowding, where the full data can be accessed from the published research data \cite{research_data_Sha2024}). It can be observed that, for each target image, the NMSE between the resulting reconstructions and their according target images decreases as the hologram bit depth increases. It infers that holograms with higher bit depth carries more sufficient information in order to better reconstruct the target images.

	\begin{figure} [ht]
		\begin{center}
			\begin{tabular}{c c}
				\includegraphics[trim={80 50 90 70}, clip, width = 0.45\textwidth]{GS_Fraunhofer_NMSE_VS_Entropy.png} &
				\includegraphics[trim={80 50 90 70}, clip, width = 0.45\textwidth]{GS_Fraunhofer_NMSE_VS_Delentropy.png} \\
				(a) & (b)
			\end{tabular}
			\caption{\label{fig:GS_Fraunhofer_NMSE_VS_Entropy_Delentropy} Scatter plot for target images set at far field. (a) NMSE v.s. Entropy. (b) NMSE v.s. Delentropy.}
		\end{center}
	\end{figure}

	Then the entropy of each of the 800 target images are calculated using Equation~(\ref{eq:shannon-entropy}), and a scatter plot of the NMSE between the reconstruction and target image against the target image entropy is plotted for all 800 target images as shown in Fig.~\ref{fig:GS_Fraunhofer_NMSE_VS_Entropy_Delentropy}~(a), with the difference in hologram bit depth distinguished by different colours. To avoid the effect of initial random phase on the final result, 5 different randomly generated initial phases are used for each run. However, the result \cite{research_data_Sha2024} had rarely shown any difference between each run, leading to 5 dots overlapping at the same spot in the scatter plot. Unfortunately, no correlation has been found between the NMSE and the target image entropy, inferring that the Shannon entropy cannot be used to quantify the difficulty of CGH for a target image.

	Lastly, the delentropy of each of the 800 target images are calculated following the method in Section \ref{sec:Delentropy}, and a scatter plot of the NMSE between the reconstruction and target image against the target image delentropy is plotted in Fig.~\ref{fig:GS_Fraunhofer_NMSE_VS_Entropy_Delentropy}~(b) for the 800 target images. And again, no correlation has been found between the NMSE and the target image delentropy either, inferring that the 2D delentropy also fails to quantify the difficulty of CGH for a target image.


\subsection{Targets at near field (Fresnel region)}
	The target images are now set to near field, where the Fresnel diffraction formula in Equation~(\ref{eq:fresnel-diffraction}) applies; therefore the FFT and IFFT stages in Fig.~\ref{fig:GS_quantized_flowchart} needs to be modified to include the phase term in Equation~(\ref{eq:fresnel-diffraction}), and for experimental purpose, the distance ($z$) is set at $10cm$, the hologram's pixel pitch (sampling resolution of $x$ and $y$) has a size of $13.62\mu m$ and the incident light's wavelength ($\lambda$) is $532nm$.
	\begin{figure} [ht]
	   \begin{center}
	   \includegraphics[width = 1.0\textwidth]{holo_bit_depth_recon_Fresnel.png}
	   \end{center}
	   \caption{\label{fig:holo_bit_depth_recon_Fresnel} Hologram generated at certain bit depths and their according reconstructions at near field}
	\end{figure}

	Fig.~\ref{fig:holo_bit_depth_recon_Fresnel} shows both qualitatively and quantitatively how the reconstruction quality improves (i.e. NMSE decreases) with the increase in the bit depth of the hologram. Such trend is the same for target images places at near field as those placed at far field in Fig.~\ref{fig:holo_bit_depth_recon_Fraunhofer}. The rotational symmetry is gone for the binary phase hologram (bit depth = 1) due to the extra phase term in the Fresnel diffraction formula making the product of binary phase hologram and the phase term to be complex-valued whose complex conjugate does not equal to itself; however, the conjugate wouldn't disappear, but to appear at a different distance to where the target image is set at, leading to extra defocused noise onto the reconstruction plane. Nevertheless, the trend infers that holograms with higher bit depth produces better quality in the reconstruction plane.

	\begin{figure} [ht]
	   \begin{center}
	   \includegraphics[trim={80 50 90 70}, clip, width = 0.45\textwidth]{GS_Fraunhofer_NMSE_VS_Hologram bit depth.png}
	   \end{center}
	   \caption{\label{fig:GS_Fresnel0.1_NMSE_VS_Hologram_bit_depth} NMSE v.s. Hologram bit depth for target images set at near field}
	\end{figure}

	Fig.~\ref{fig:GS_Fresnel0.1_NMSE_VS_Hologram_bit_depth} plots the trend of NMSE against increasing hologram bit depth, for every 5 target images to avoid overcrowding the plot, with all raw data accessible at the published research data \cite{research_data_Sha2024} (as the results for Fraunhofer has shown that the result from different initial random phases are the same, each run for Fresnel propagation only starts with one initial random phase as opposed to 5 different random phases for Fraunhofer propagation). In Fig.~\ref{fig:GS_Fresnel0.1_NMSE_VS_Hologram_bit_depth}, the same trend as the one for far field in Fig.~\ref{fig:GS_Fraunhofer_NMSE_VS_Hologram_bit_depth} can be observed, where NMSE decreases as hologram bit depth increases, for every single target image.


	\begin{figure} [ht]
		\begin{center}
			\begin{tabular}{c c}
				\includegraphics[trim={80 50 90 70}, clip, width = 0.45\textwidth]{GS_Fresnel0.1_NMSE_VS_Entropy.png} &
				\includegraphics[trim={80 50 90 70}, clip, width = 0.45\textwidth]{GS_Fresnel0.1_NMSE_VS_Delentropy.png} \\
				(a) & (b)
			\end{tabular}
			\caption{\label{fig:GS_Fresnel0.1_NMSE_VS_Entropy_Delentropy} Scatter plot for target images set at near field. (a) NMSE v.s. Entropy. (b) NMSE v.s. Delentropy.}
		\end{center}
	\end{figure}

	The scatter plot of NMSE against target image's entropy and delentropy are plotted, in Fig.~\ref{fig:GS_Fresnel0.1_NMSE_VS_Entropy_Delentropy}~(a)~and~(b) respectively. No correlation has been observed between the NMSE and either the entropy or delentropy of target image. Such `no correlation observed' result is the same as the results for the targets in far field in Section~\ref{sec:Fraunhofer_results}, confirming that neither entropy nor delentropy is suitable for quantifying how difficult a target image is for phase hologram computation.

	\begin{figure} [ht]
		\begin{center}
			\begin{tabular}{c c}
				\includegraphics[trim={90 50 60 80}, clip, width = 0.45\textwidth]{GS_Fresnel0.1_iterations_zero_start.png} &
				\includegraphics[trim={90 50 60 80}, clip, width = 0.45\textwidth]{GS_Fresnel0.1_iterations_random_start.png} \\
				(a) & (b)
			\end{tabular}
			\caption{\label{fig:GS_Fresnel0.1_iterations} Hologram entropy and NMSE v.s. iteration number for target images set at near field, with the initial phase ($\angle A$) being (a) zeros (b) random}
		\end{center}
	\end{figure}

	The research moves on to investigate the entropy of holograms. In an example run for a quantized hologram generation in the near field (Fresnel propagation in Equation~(\ref{eq:fresnel-diffraction}), both the hologram entropy and the NMSE between reconstruction and target image are recorded and plotted in Fig.~\ref{fig:GS_Fresnel0.1_iterations}~(a)~and~(b) for the first 20 iterations. As randomly generated holograms will by definition create holograms with high entropy, additional experiment has been carried out with initial phase set to zeros (i.e. $\angle A$ is set to zeros at $n=0$ in Fig.~\ref{fig:GS_quantized_flowchart}). Therefore, two diagrams are plotted in Fig.~\ref{fig:GS_Fresnel0.1_iterations}, with Fig.~\ref{fig:GS_Fresnel0.1_iterations}~(a) having initial phase of zeros and Fig.~\ref{fig:GS_Fresnel0.1_iterations}~(b) having random initial phase. Both Fig.~\ref{fig:GS_Fresnel0.1_iterations}~(a)~and~(b) have the horizontal axis to be the iteration number $n$, and the vertical axis in the left is the entropy of hologram (corresponding to solid lines in the plot), while the vertical axis in the right is the NMSE (corresponding to dotted lines in the plot). Colour coding is used to distinguish between the 8 different runs where hologram bit depth is set from 1 to 8.

	The solid lines in Fig.~\ref{fig:GS_Fresnel0.1_iterations}~(a) show that the entropy of hologram keeps increasing towards a value lower than the bit depth, with their corresponding NMSE between reconstruction and target image (dotted lines) decreasing. Such trend can be explained qualitatively that, as the iteration goes on, the hologram is attempting to contain more information to sustain a better reconstruction, while the entropy cannot exceed or even reach the bit depth level. On the other hand, the random initial phase plotted in Fig.~\ref{fig:GS_Fresnel0.1_iterations}~(b) has a constant entropy approximately equal to the bit depth, which infers that the iterations are improving the reconstruction quality without reducing the information entropy of the hologram. In both cases, the entropy of the hologram does not decrease at any iteration, and the final NMSE does not have significant reduction when the hologram's bit depth exceeds 5.

	The entropy of final hologram in (a) is lower than that in (b), although the final NMSE are similar. If the computer-generated holograms were to undergo a lossless compression, the hologram in (a) would be better compressed than the hologram in (b) as the entropy denotes the compression limit, assuming that the holograms are treated as 1D arrays when compressing. Therefore if hologram compression is of a concern, then starting with a low entropy initial hologram in the CGH process is recommended. In case if the reconstruction quality is not as high of a priority than making holograms to occupy less storage space, this paper also recommends quantized GS algorithm with 5 bit depth instead of 6-7 bit depth as the final reconstruction quality will not degrade significantly.



\section{Conclusion}
	By carrying out the quantized GS algorithm on 800 sample target images placed at both far field (Fraunhofer diffraction) and near field (Fresnel diffraction), and computing the entropy and delentropy of the target images and holograms, this paper reaches the conclusion that, holograms with higher bit depth can sustain more information therefore producing better quality reconstructions. However, the quality of the reconstruction is not correlated to either the entropy or the delentropy of the target image, so neither entropy nor delentropy can quantify how difficult an image is for phase-only hologram generation. Additionally, the entropy of the hologram generated using quantized GS algorithm is not only bounded by the hologram bit depth, but also affected by the entropy of the initial phase. For applications where holograms file size is a high priority, if the quantized GS method is used, this paper advises a low entropy initial phase (e.g. all zeros) rather than a random initial phase and recommends to reduce the hologram bit depth limit, for lower entropy hologram generation.
